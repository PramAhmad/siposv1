import{_ as T}from"./nuxt-link.7185a162.js";import{a as q,_ as F}from"./SectionMain.d4578193.js";import{_ as I}from"./BaseButton.214b4472.js";import{_ as J}from"./BaseButtons.1a714a7d.js";import{_ as V}from"./CardBox.6b3f7427.js";import{r as f,h as R,i as A,x as E,j as H,q as z,w as l,f as K,o as d,b as s,k as i,c as u,l as O,s as k,F as C,a,H as P,J as U,m as W,t as p,d as Y}from"./entry.8c7ce858.js";import{n as G,m as Q,a as X}from"./mdi.70a351a6.js";import"./colors.7637652d.js";import"./config.edcd5bec.js";import"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js";import"https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js";const Z={key:0,class:"fixed top-0 left-0 right-0 bottom-0 flex items-center justify-center z-50 bg-white"},aa=a("div",{class:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-gray-900"},null,-1),ea=[aa],ta=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 inline-block",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),oa={class:"flex flex-col lg:flex-row gap-3 mb-6"},na={class:"flex-1"},sa=a("thead",null,[a("tr",null,[a("th",null,"No"),a("th",null,"Nama Mahasiswa"),a("th",null,"Kelas"),a("th",null,"Jumlah Bayar"),a("th",null,"Tanggal Bayar"),a("th",null,"Action")])],-1),ra={"data-label":"no"},la={"data-label":"nama"},ia={"data-label":"kelas",class:"uppercase"},ma={"data-label":"jumlah bayar"},ca={"data-label":"jumlah bayar"},da={class:"before:hidden lg:w-1 whitespace-nowrap"},_a={class:"flex gap-3 justify-center"},ua={class:"flex justify-center"},Na={__name:"index",setup(pa){let m=f([]),x=f([]),r=f("");const b=f(!1),y=R(),h=A(),B=async()=>{const{data:e,error:t}=await y.from("room_payment").select("id,nama_pembayaran, desc").eq("id",h.params.room);t?console.log(t):x.value=e},v=async()=>{b.value=!1;const{data:e,error:t}=await y.from("payment").select("id,total_bayar, tanggal_bayar, mahasiswa_id(id,nama, kelas), payment_id(nama_pembayaran, desc)").eq("payment_id",h.params.room).limit(5).order("id",{ascending:!1});t&&console.error(t),e.forEach(n=>{n.total_bayar=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(n.total_bayar)}),m.value=e.map(n=>({...n,tanggal_bayar:N(n.tanggal_bayar)})),b.value=!0},L=async e=>{if(window.confirm("yakin akan menghapus?")){const{data:n,error:c}=await y.from("payment").delete().eq("id",e);c?console.log(c):v()}},N=e=>{const t=new Date(e),n=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],c=t.getDate(),_=t.getMonth(),g=t.getFullYear(),w=n[_];return`${c} ${w} ${g}`},j=async()=>{const{data:e,error:t}=await y.from("payment").select("id,total_bayar, tanggal_bayar, mahasiswa_id(id,nama, kelas), payment_id(nama_pembayaran, desc)").eq("payment_id",h.params.room).order("id",{ascending:!1}).range(m.value.length,m.value.length+5);t&&console.error(t),m.value=[...m.value,...e]},M=E(()=>m.value.filter(e=>e.mahasiswa_id.nama.toLowerCase().includes(r.value.toLowerCase())||e.mahasiswa_id.kelas.toLowerCase().includes(r.value.toLowerCase())||e.total_bayar.toString().toLowerCase().includes(r.value.toLowerCase())||e.tanggal_bayar.toLowerCase().includes(r.value.toLowerCase())));return H(()=>{v(),B()}),(e,t)=>{const n=T,c=F,_=I,g=J,w=V,D=q,$=K;return d(),z($,{name:"authenticated"},{default:l(()=>[s(D,null,{default:l(()=>[i(b)?O("",!0):(d(),u("div",Z,ea)),(d(!0),u(C,null,k(i(x),o=>(d(),u("div",{key:o.id},[s(c,{icon:i(G),title:"payment "+o.nama_pembayaran,main:""},{default:l(()=>[s(n,{to:`/admin/payment/${o.id}/tambah`,class:"rounded-md border-2 border-gray-900 py-1.5 px-1.5"},{default:l(()=>[ta]),_:2},1032,["to"])]),_:2},1032,["icon","title"])]))),128)),a("div",oa,[a("div",na,[P(a("input",{type:"text",class:"form-input",placeholder:"Cari nama mahasiswa, kelas, jumlah bayar, tanggal bayar","onUpdate:modelValue":t[0]||(t[0]=o=>W(r)?r.value=o:r=o)},null,512),[[U,i(r)]])])]),s(w,{class:"mb-6","has-table":""},{default:l(()=>[a("table",null,[sa,a("tbody",null,[(d(!0),u(C,null,k(i(M),(o,S)=>(d(),u("tr",{key:o.id},[a("td",ra,p(S+1),1),a("td",la,[s(n,{to:"/admin/mahasiswa/"+o.mahasiswa_id.id},{default:l(()=>[Y(p(o.mahasiswa_id.nama),1)]),_:2},1032,["to"])]),a("td",ia,p(o.mahasiswa_id.kelas),1),a("td",ma,p(o.total_bayar),1),a("td",ca,p(o.tanggal_bayar),1),a("td",da,[a("div",_a,[s(n,{to:"/admin/payment/"+i(h).params.room+"/"+o.id},{default:l(()=>[s(_,{color:"primary",icon:i(Q),small:""},null,8,["icon"])]),_:2},1032,["to"]),s(g,{type:"justify-start lg:justify-end","no-wrap":""},{default:l(()=>[s(_,{color:"danger",icon:i(X),small:"",onClick:ya=>L(o.id)},null,8,["icon","onClick"])]),_:2},1024)])])]))),128))])])]),_:1}),a("div",ua,[s(_,{color:"primary",onClick:j,label:"more"})])]),_:1})]),_:1})}}};export{Na as default};
