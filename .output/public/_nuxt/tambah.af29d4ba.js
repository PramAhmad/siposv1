import{a as P,_ as U}from"./SectionMain.d4578193.js";import{_ as O}from"./NotificationBarInCard.5405e40b.js";import{a as q,_ as z}from"./FormControl.06cdc0db.js";import{_ as A}from"./BaseButton.214b4472.js";import{_ as E}from"./BaseButtons.1a714a7d.js";import{_ as J}from"./CardBox.6b3f7427.js";import{B as W}from"./colors.7637652d.js";import{r as c,E as G,h as H,i as K,K as Q,j as X,q as Y,w as u,f as Z,o as l,b as t,c as _,s as k,k as i,F as g,l as ee,a as n,m as w,n as ae,t as x}from"./entry.8c7ce858.js";import"./mdi.70a351a6.js";import"./config.edcd5bec.js";import"./main.ad903eef.js";import"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js";import"https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js";const oe={key:0,class:"bg-blue-100 border-t border-b border-blue-500 text-blue-700 px-4 py-3",role:"alert"},te=n("p",{class:"font-bold"},"Transaksi",-1),ne=n("p",{class:"text-sm"},"Transaksi Berhasil",-1),se=[te,ne],re=["onSubmit"],le=["value"],ie=n("button",{type:"submit",class:"py-2 px-5 bg-sky-600 rounded-md text-white hover:bg-sky-500"},"Tambah",-1),me={class:"fixed bottom-4 right-4 z-50"},Be={__name:"tambah",setup(ce){const m=c(""),s=c(""),B=G(),d=c(!1),h=H(),y=K(),f=c([]),p=c([]),T=async()=>{try{const{data:e}=await h.from("room_payment").select("id, nama_pembayaran, desc").eq("id",y.params.room);f.value=e}catch(e){console.error(e)}},N=async e=>{const{data:a,error:r}=await h.from("mahasiswa").select("id,nama,kelas").ilike("nama","%"+e.target.value+"%");p.value=a,r&&console.error(r)},M=async e=>{const a="https://discordapp.com/api/webhooks/1157344823666294784/5l_evA92FI2JNTOHlyUhj-zr_xMLyhaLAmII8hPOMhubBErwUfiwqLTRJON72sISLn4W",r={content:e};try{(await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok?console.log("Pesan berhasil dikirim ke Discord"):console.error("Gagal mengirim pesan ke Discord")}catch(b){console.error("Gagal mengirim pesan ke Discord:",b)}},S=async()=>{d.value=!1;try{const{error:e}=await h.from("payment").insert({mahasiswa_id:p.value[0].id,payment_id:y.params.room,total_bayar:s.value,add_by:B.value.id});if(e)d(e.message);else{const a=`
      \`\`\`md
  Terimakasih sudah bayar

 Informasi Pembayaran:
  -Nama: ${p.value[0].nama}
  -Total Bayar: Rp ${s.value}
  -Tanggal Bayar: ${new Date().toLocaleDateString()} 
  -Nama Pembayaran: ${f.value[0].nama_pembayaran}
  \`\`\`
  `;m.value="",s.value="",M(a),d.value=!0}}catch(e){console.error(e)}},C=()=>{m.value="",s.value=""},I=Q();return X(()=>{T()}),(e,a)=>{const r=U,b=O,v=q,L=z,V=A,D=E,R=J,$=P,j=W,F=Z;return l(),Y(F,{name:"authenticated"},{default:u(()=>[t($,null,{default:u(()=>[(l(!0),_(g,null,k(i(f),o=>(l(),_("div",{key:o.id},[t(r,{icon:e.mdiTableBorder,title:"payment "+o.nama_pembayaran,main:""},null,8,["icon","title"])]))),128)),i(d)?(l(),_("div",oe,se)):ee("",!0),t(R,null,{default:u(()=>[t(b,{color:"info",icon:e.mdiMonitorCellphone,class:"mb-6"},null,8,["icon"]),n("form",{onSubmit:ae(S,["prevent"])},[t(L,{label:"Masukan Nama dan jumlah"},{default:u(()=>[t(v,{modelValue:i(m),"onUpdate:modelValue":a[0]||(a[0]=o=>w(m)?m.value=o:null),icon:e.mdiMail,placeholder:"Nama Mahasiswa",onInput:N},null,8,["modelValue","icon"]),(l(!0),_(g,null,k(i(p),o=>(l(),_("div",{key:o.id,class:"flex items-center"},[n("input",{type:"radio",value:o.id,class:"mr-2"},null,8,le),n("label",null,x(o.nama)+" - "+x(o.kelas),1)]))),128)),t(v,{modelValue:i(s),"onUpdate:modelValue":a[1]||(a[1]=o=>w(s)?s.value=o:null),icon:e.mdiMail,placeholder:"jumlah bayar"},null,8,["modelValue","icon"])]),_:1}),n("div",null,[t(D,null,{default:u(()=>[ie,t(V,{onClick:C,color:"info",outline:"",label:"Reset"})]),_:1})])],40,re)]),_:1})]),_:1}),n("div",me,[n("button",{onClick:a[2]||(a[2]=o=>i(I).back()),class:"flex items-center justify-center w-10 h-10 rounded-full text-white bg-blue-600 dark:bg-blue-600 shadow-lg"},[t(j,{path:e.mdiArrowLeft,size:"24px",color:"white"},null,8,["path"])])])]),_:1})}}};export{Be as default};
